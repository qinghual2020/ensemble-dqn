Collecting experience...
Ep:  0 | Ep_r:  25.0 | Steps:  24 | Ep_Loss: 0.0000
Ep:  20 | Ep_r:  10.0 | Steps:  9 | Ep_Loss: 0.0000
Ep:  40 | Ep_r:  15.0 | Steps:  14 | Ep_Loss: 0.0000
Ep:  60 | Ep_r:  12.0 | Steps:  11 | Ep_Loss: 0.0000
Ep:  80 | Ep_r:  16.0 | Steps:  15 | Ep_Loss: 0.0000
Ep:  100 | Ep_r:  20.0 | Steps:  19 | Ep_Loss: 3.5352
Ep:  120 | Ep_r:  14.0 | Steps:  13 | Ep_Loss: 1.1503
/home/quantumiracle/research/ensemble-dqn/dqn.py:135: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:201.)
  wrap_tensor = lambda x: torch.tensor([x])
Ep:  140 | Ep_r:  17.0 | Steps:  16 | Ep_Loss: 1.1964
Ep:  160 | Ep_r:  75.0 | Steps:  74 | Ep_Loss: 2.4663
Ep:  180 | Ep_r:  10.0 | Steps:  9 | Ep_Loss: 0.3988
Ep:  200 | Ep_r:  32.0 | Steps:  31 | Ep_Loss: 0.7408
Ep:  220 | Ep_r:  46.0 | Steps:  45 | Ep_Loss: 0.9158
Ep:  240 | Ep_r:  31.0 | Steps:  30 | Ep_Loss: 0.3975
Ep:  260 | Ep_r:  150.0 | Steps:  149 | Ep_Loss: 1.3914
Ep:  280 | Ep_r:  163.0 | Steps:  162 | Ep_Loss: 1.4183
Ep:  300 | Ep_r:  169.0 | Steps:  168 | Ep_Loss: 0.9628
Ep:  320 | Ep_r:  363.0 | Steps:  362 | Ep_Loss: 1.8800
Ep:  340 | Ep_r:  239.0 | Steps:  238 | Ep_Loss: 2.4189
Ep:  360 | Ep_r:  169.0 | Steps:  168 | Ep_Loss: 1.0491
Ep:  380 | Ep_r:  500.0 | Steps:  499 | Ep_Loss: 2.5550
Ep:  400 | Ep_r:  500.0 | Steps:  499 | Ep_Loss: 2.8246
Ep:  420 | Ep_r:  500.0 | Steps:  499 | Ep_Loss: 3.0235
Traceback (most recent call last):
  File "train_dqn.py", line 83, in <module>
  File "train_dqn.py", line 54, in rollout
    if epi % SAVE_INTERVAL == 0:
  File "/home/quantumiracle/research/ensemble-dqn/dqn.py", line 202, in learn
    Q_s_prime_a_prime[none_terminal_next_state_index] = self.target_net(none_terminal_next_states).detach().max(1)[0].unsqueeze(1)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/quantumiracle/research/ensemble-dqn/dqn.py", line 80, in forward
    o = self.linear(x)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
